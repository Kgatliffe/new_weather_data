############################################################################################################
Preamble
############################################################################################################
Markdown Options
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, include = FALSE)
```
############################################################################################################
Clear working environment, Set Working Directory to Variable WD
```{r include=FALSE}
rm(list=ls())
WD="/Users/lee/Documents/GitHub/new_weather_data"
setwd(WD)
rm(WD)
```
############################################################################################################
Install Packages
```{r include=FALSE}
install.packages("dplyr")
install.packages("lubridate")
install.packages("tidyverse")
```
############################################################################################################
Load Packages
```{r include=FALSE}
library(dplyr)
library(lubridate)
library(tidyverse)
require(caTools)
```
############################################################################################################
############################################################################################################



############################################################################################################
Load Data, Assign Column Names and Create Time-"Lubridate" Variables
############################################################################################################
Load Data files to denver
```{r include=FALSE}
load("DenverK.rda")
```
############################################################################################################
Create Time-Formatting variable data for Denver data
```{r include=FALSE}
dt_iso_col_denver=Denver$dt_iso
year_Den=year(dt_iso_col_denver)
month_Den=month(dt_iso_col_denver)
day_Den=day(dt_iso_col_denver)
hour_Den=hour(dt_iso_col_denver)
Denver$Year=NA
Denver$Year=year_Den
Denver$Month=NA
Denver$Month=month_Den
Denver$Day=NA
Denver$Day=day_Den
Denver$Hour=NA
Denver$Hour=hour_Den
rm(dt_iso_col_denver)
rm(year_Den)
rm(month_Den)
rm(day_Den)
rm(hour_Den)
```
############################################################################################################
############################################################################################################



############################################################################################################
Create Time-offset data
############################################################################################################
Create -1H, -3H, -6H, -12H, -24H Time indicator columns for Denver data
```{r}
Denver$ind_1=NA
Denver$ind_3=NA
Denver$ind_6=NA
Denver$ind_12=NA
Denver$ind_24=NA


for (i in 2:35888)
{ 
    if((Denver$Hour[i-1]+1==Denver$Hour[i]) | (Denver$Hour[i-1]==23 & Denver$Hour[i]==0))
    {Denver$ind_1[i]<-1}
    else
    {Denver$ind_1[i]<-0}
}


for(i in 5:35888)
{
  if(Denver$ind_1[i-3]==1)
    {Denver$ind_3[i]=3}
  else
    {Denver$ind_3[i]=0}
}


for(i in 8:35888)
{
  if(Denver$ind_1[i-6]==1)
    {Denver$ind_6[i]=6}
  else
    {Denver$ind_6[i]=0}
}

for(i in 14:35888)
{
    if(Denver$ind_1[i-12]==1)
      {Denver$ind_12[i]=12}
    else
      {Denver$ind_12[i]=0}
}

for(i in 26:35888)
{
  if(Denver$ind_1[i-24]==1)
    {Denver$ind_24[i]=24}
  else
    {Denver$ind_24[i]=0}
}
rm(i)
```
############################################################################################################
Create New -1H-Denver Data Set
```{r include=FALSE}
dt_1h_Den=c()         
temp_1h_Den=c()              
temp_min_1h_Den=c()     
temp_max_1h_Den=c()        
pressure_1h_Den=c()           
humidity_1h_Den=c()           
wind_speed_1h_Den=c()      
wind_deg_1h_Den=c()          
rain_1h_1h_Den=c()            
rain_3h_1h_Den=c()           
snow_1h_1h_Den=c()            
snow_3h_1h_Den=c()            
clouds_all_1h_Den=c()          
weather_id_1h_Den=c()         
weather_main_1h_Den=c()      
weather_description_1h_Den=c() 

for(i in 2:35888)
{ 
  if (Denver$ind_1[i]==1)
  {
    dt_1h_Den[i]=Denver$dt[i-1]         
    temp_1h_Den[i]=Denver$temp[i-1]              
    temp_min_1h_Den[i]=Denver$temp_min[i-1]     
    temp_max_1h_Den[i]=Denver$temp_max[i-1]        
    pressure_1h_Den[i]=Denver$pressure[i-1]           
    humidity_1h_Den[i]=Denver$humidity[i-1]           
    wind_speed_1h_Den[i]=Denver$wind_speed[i-1]      
    wind_deg_1h_Den[i]=Denver$wind_deg[i-1]          
    rain_1h_1h_Den[i]=Denver$rain_1h[i-1]            
    rain_3h_1h_Den[i]=Denver$rain_3h[i-1]           
    snow_1h_1h_Den[i]=Denver$snow_1h[i-1]            
    snow_3h_1h_Den[i]=Denver$snow_3h[i-1]            
    clouds_all_1h_Den[i]=Denver$clouds_all[i-1]          
    weather_id_1h_Den[i]=Denver$weather_id[i-1]         
    weather_main_1h_Den[i]=Denver$weather_main[i-1]      
    weather_description_1h_Den[i]=Denver$weather_description[i-1] 
  }
}

Denver_1h=data.frame(dt_1h_Den,         
                     temp_1h_Den,              
                     temp_min_1h_Den,     
                     temp_max_1h_Den,        
                     pressure_1h_Den,         
                     humidity_1h_Den,           
                     wind_speed_1h_Den,      
                     wind_deg_1h_Den,          
                     rain_1h_1h_Den,            
                     rain_3h_1h_Den,           
                     snow_1h_1h_Den,            
                     snow_3h_1h_Den,            
                     clouds_all_1h_Den,          
                     weather_id_1h_Den,         
                     weather_main_1h_Den,      
                     weather_description_1h_Den) 
save(Denver_1h, file = 'Denver_1h.rda')
```
############################################################################################################
Create New -3H-Denver Data Set
```{r include=FALSE}
dt_3h_Den=c()         
temp_3h_Den=c()              
temp_min_3h_Den=c()     
temp_max_3h_Den=c()        
pressure_3h_Den=c()           
humidity_3h_Den=c()           
wind_speed_3h_Den=c()      
wind_deg_3h_Den=c()          
rain_1h_3h_Den=c()            
rain_3h_3h_Den=c()           
snow_1h_3h_Den=c()            
snow_3h_3h_Den=c()            
clouds_all_3h_Den=c()          
weather_id_3h_Den=c()         
weather_main_3h_Den=c()      
weather_description_3h_Den=c() 

dt_3h_Den[1:35888]=NA         
temp_3h_Den[1:35888]=NA              
temp_min_3h_Den[1:35888]=NA     
temp_max_3h_Den[1:35888]=NA        
pressure_3h_Den[1:35888]=NA           
humidity_3h_Den[1:35888]=NA           
wind_speed_3h_Den[1:35888]=NA      
wind_deg_3h_Den[1:35888]=NA          
rain_1h_3h_Den[1:35888]=NA            
rain_3h_3h_Den[1:35888]=NA           
snow_1h_3h_Den[1:35888]=NA            
snow_3h_3h_Den[1:35888]=NA            
clouds_all_3h_Den[1:35888]=NA          
weather_id_3h_Den[1:35888]=NA         
weather_main_3h_Den[1:35888]=NA      
weather_description_3h_Den[1:35888]=NA 


for(i in 5:35888)
{ 
  if (Denver$ind_3[i]==3)
  {
    dt_3h_Den[i]=Denver$dt[i-3]         
    temp_3h_Den[i]=Denver$temp[i-3]              
    temp_min_3h_Den[i]=Denver$temp_min[i-3]     
    temp_max_3h_Den[i]=Denver$temp_max[i-3]        
    pressure_3h_Den[i]=Denver$pressure[i-3]           
    humidity_3h_Den[i]=Denver$humidity[i-3]           
    wind_speed_3h_Den[i]=Denver$wind_speed[i-3]      
    wind_deg_3h_Den[i]=Denver$wind_deg[i-3]          
    rain_1h_3h_Den[i]=Denver$rain_1h[i-3]            
    rain_3h_3h_Den[i]=Denver$rain_3h[i-3]           
    snow_1h_3h_Den[i]=Denver$snow_1h[i-3]            
    snow_3h_3h_Den[i]=Denver$snow_3h[i-3]            
    clouds_all_3h_Den[i]=Denver$clouds_all[i-3]          
    weather_id_3h_Den[i]=Denver$weather_id[i-3]         
    weather_main_3h_Den[i]=Denver$weather_main[i-3]      
    weather_description_3h_Den[i]=Denver$weather_description[i-3] 
  }
}

Denver_3h=data.frame(dt_3h_Den,         
                     temp_3h_Den,              
                     temp_min_3h_Den,     
                     temp_max_3h_Den,        
                     pressure_3h_Den,         
                     humidity_3h_Den,           
                     wind_speed_3h_Den,      
                     wind_deg_3h_Den,          
                     rain_1h_3h_Den,            
                     rain_3h_3h_Den,           
                     snow_1h_3h_Den,            
                     snow_3h_3h_Den,            
                     clouds_all_3h_Den,          
                     weather_id_3h_Den,         
                     weather_main_3h_Den,      
                     weather_description_3h_Den) 
save(Denver_3h, file = 'Denver_3h.rda')
```
############################################################################################################
Create New -6H-Denver Data Set
```{r include=FALSE}
dt_6h_Den=c()         
temp_6h_Den=c()              
temp_min_6h_Den=c()     
temp_max_6h_Den=c()        
pressure_6h_Den=c()           
humidity_6h_Den=c()           
wind_speed_6h_Den=c()      
wind_deg_6h_Den=c()          
rain_1h_6h_Den=c()            
rain_3h_6h_Den=c()           
snow_1h_6h_Den=c()            
snow_3h_6h_Den=c()            
clouds_all_6h_Den=c()          
weather_id_6h_Den=c()         
weather_main_6h_Den=c()      
weather_description_6h_Den=c() 

dt_6h_Den[1:35888]=NA         
temp_6h_Den[1:35888]=NA              
temp_min_6h_Den[1:35888]=NA     
temp_max_6h_Den[1:35888]=NA        
pressure_6h_Den[1:35888]=NA           
humidity_6h_Den[1:35888]=NA           
wind_speed_6h_Den[1:35888]=NA      
wind_deg_6h_Den[1:35888]=NA          
rain_1h_6h_Den[1:35888]=NA            
rain_3h_6h_Den[1:35888]=NA           
snow_1h_6h_Den[1:35888]=NA            
snow_3h_6h_Den[1:35888]=NA            
clouds_all_6h_Den[1:35888]=NA          
weather_id_6h_Den[1:35888]=NA         
weather_main_6h_Den[1:35888]=NA      
weather_description_6h_Den[1:35888]=NA 


for(i in 8:35888)
{ 
  if (Denver$ind_6[i]==6)
  {
    dt_6h_Den[i]=Denver$dt[i-6]         
    temp_6h_Den[i]=Denver$temp[i-6]              
    temp_min_6h_Den[i]=Denver$temp_min[i-6]     
    temp_max_6h_Den[i]=Denver$temp_max[i-6]        
    pressure_6h_Den[i]=Denver$pressure[i-6]           
    humidity_6h_Den[i]=Denver$humidity[i-6]           
    wind_speed_6h_Den[i]=Denver$wind_speed[i-6]      
    wind_deg_6h_Den[i]=Denver$wind_deg[i-6]          
    rain_1h_6h_Den[i]=Denver$rain_1h[i-6]            
    rain_3h_6h_Den[i]=Denver$rain_3h[i-6]           
    snow_1h_6h_Den[i]=Denver$snow_1h[i-6]            
    snow_3h_6h_Den[i]=Denver$snow_3h[i-6]            
    clouds_all_6h_Den[i]=Denver$clouds_all[i-6]          
    weather_id_6h_Den[i]=Denver$weather_id[i-6]         
    weather_main_6h_Den[i]=Denver$weather_main[i-6]      
    weather_description_6h_Den[i]=Denver$weather_description[i-6] 
  }
}

Denver_6h=data.frame(dt_6h_Den,
                     temp_6h_Den,
                     temp_min_6h_Den,     
                     temp_max_6h_Den,
                     pressure_6h_Den,         
                     humidity_6h_Den,           
                     wind_speed_6h_Den,      
                     wind_deg_6h_Den,          
                     rain_1h_6h_Den,            
                     rain_3h_6h_Den,           
                     snow_1h_6h_Den,            
                     snow_3h_6h_Den,            
                     clouds_all_6h_Den,          
                     weather_id_6h_Den,         
                     weather_main_6h_Den,      
                     weather_description_6h_Den) 
save(Denver_6h, file = 'Denver_6h.rda')
```
############################################################################################################
Create New -12H-Denver Data Set
```{r include=FALSE}
dt_12h_Den=c()         
temp_12h_Den=c()              
temp_min_12h_Den=c()     
temp_max_12h_Den=c()        
pressure_12h_Den=c()           
humidity_12h_Den=c()           
wind_speed_12h_Den=c()      
wind_deg_12h_Den=c()          
rain_1h_12h_Den=c()            
rain_3h_12h_Den=c()           
snow_1h_12h_Den=c()            
snow_3h_12h_Den=c()            
clouds_all_12h_Den=c()          
weather_id_12h_Den=c()         
weather_main_12h_Den=c()      
weather_description_12h_Den=c() 

dt_12h_Den[1:35888]=NA         
temp_12h_Den[1:35888]=NA              
temp_min_12h_Den[1:35888]=NA     
temp_max_12h_Den[1:35888]=NA        
pressure_12h_Den[1:35888]=NA           
humidity_12h_Den[1:35888]=NA           
wind_speed_12h_Den[1:35888]=NA      
wind_deg_12h_Den[1:35888]=NA          
rain_1h_12h_Den[1:35888]=NA            
rain_3h_12h_Den[1:35888]=NA           
snow_1h_12h_Den[1:35888]=NA            
snow_3h_12h_Den[1:35888]=NA            
clouds_all_12h_Den[1:35888]=NA          
weather_id_12h_Den[1:35888]=NA         
weather_main_12h_Den[1:35888]=NA      
weather_description_12h_Den[1:35888]=NA 


for(i in 14:35888)
{ 
  if (Denver$ind_12[i]==12)
  {
    dt_12h_Den[i]=Denver$dt[i-12]         
    temp_12h_Den[i]=Denver$temp[i-12]              
    temp_min_12h_Den[i]=Denver$temp_min[i-12]     
    temp_max_12h_Den[i]=Denver$temp_max[i-12]        
    pressure_12h_Den[i]=Denver$pressure[i-12]           
    humidity_12h_Den[i]=Denver$humidity[i-12]           
    wind_speed_12h_Den[i]=Denver$wind_speed[i-12]      
    wind_deg_12h_Den[i]=Denver$wind_deg[i-12]          
    rain_1h_12h_Den[i]=Denver$rain_1h[i-12]            
    rain_3h_12h_Den[i]=Denver$rain_3h[i-12]           
    snow_1h_12h_Den[i]=Denver$snow_1h[i-12]            
    snow_3h_12h_Den[i]=Denver$snow_3h[i-12]            
    clouds_all_12h_Den[i]=Denver$clouds_all[i-12]          
    weather_id_12h_Den[i]=Denver$weather_id[i-12]         
    weather_main_12h_Den[i]=Denver$weather_main[i-12]      
    weather_description_12h_Den[i]=Denver$weather_description[i-12] 
  }
}


Denver_12h=data.frame(dt_12h_Den,
                     temp_12h_Den,
                     temp_min_12h_Den,     
                     temp_max_12h_Den,
                     pressure_12h_Den,         
                     humidity_12h_Den,           
                     wind_speed_12h_Den,      
                     wind_deg_12h_Den,          
                     rain_1h_12h_Den,            
                     rain_3h_12h_Den,           
                     snow_1h_12h_Den,            
                     snow_3h_12h_Den,            
                     clouds_all_12h_Den,          
                     weather_id_12h_Den,         
                     weather_main_12h_Den,      
                     weather_description_12h_Den) 
save(Denver_12h, file = 'Denver_12h.rda')
```
############################################################################################################
Create New -24H-Denver Data Set
```{r include=FALSE}
dt_24h_Den=c()         
temp_24h_Den=c()              
temp_min_24h_Den=c()     
temp_max_24h_Den=c()        
pressure_24h_Den=c()           
humidity_24h_Den=c()           
wind_speed_24h_Den=c()      
wind_deg_24h_Den=c()          
rain_1h_24h_Den=c()            
rain_3h_24h_Den=c()           
snow_1h_24h_Den=c()            
snow_3h_24h_Den=c()            
clouds_all_24h_Den=c()          
weather_id_24h_Den=c()         
weather_main_24h_Den=c()      
weather_description_24h_Den=c() 

dt_24h_Den[1:35888]=NA         
temp_24h_Den[1:35888]=NA              
temp_min_24h_Den[1:35888]=NA     
temp_max_24h_Den[1:35888]=NA        
pressure_24h_Den[1:35888]=NA           
humidity_24h_Den[1:35888]=NA           
wind_speed_24h_Den[1:35888]=NA      
wind_deg_24h_Den[1:35888]=NA          
rain_1h_24h_Den[1:35888]=NA            
rain_3h_24h_Den[1:35888]=NA           
snow_1h_24h_Den[1:35888]=NA            
snow_3h_24h_Den[1:35888]=NA            
clouds_all_24h_Den[1:35888]=NA          
weather_id_24h_Den[1:35888]=NA         
weather_main_24h_Den[1:35888]=NA      
weather_description_24h_Den[1:35888]=NA 

for(i in 26:35888)
{ 
  if (Denver$ind_24[i]==24)
  {
    dt_24h_Den[i]=Denver$dt[i-24]         
    temp_24h_Den[i]=Denver$temp[i-24]              
    temp_min_24h_Den[i]=Denver$temp_min[i-24]     
    temp_max_24h_Den[i]=Denver$temp_max[i-24]        
    pressure_24h_Den[i]=Denver$pressure[i-24]           
    humidity_24h_Den[i]=Denver$humidity[i-24]           
    wind_speed_24h_Den[i]=Denver$wind_speed[i-24]      
    wind_deg_24h_Den[i]=Denver$wind_deg[i-24]          
    rain_1h_24h_Den[i]=Denver$rain_1h[i-24]            
    rain_3h_24h_Den[i]=Denver$rain_3h[i-24]           
    snow_1h_24h_Den[i]=Denver$snow_1h[i-24]            
    snow_3h_24h_Den[i]=Denver$snow_3h[i-24]            
    clouds_all_24h_Den[i]=Denver$clouds_all[i-24]          
    weather_id_24h_Den[i]=Denver$weather_id[i-24]         
    weather_main_24h_Den[i]=Denver$weather_main[i-24]      
    weather_description_24h_Den[i]=Denver$weather_description[i-24] 
  }
}


Denver_24h=data.frame(dt_24h_Den,
                     temp_24h_Den,
                     temp_min_24h_Den,     
                     temp_max_24h_Den,
                     pressure_24h_Den,         
                     humidity_24h_Den,           
                     wind_speed_24h_Den,      
                     wind_deg_24h_Den,          
                     rain_1h_24h_Den,            
                     rain_3h_24h_Den,           
                     snow_1h_24h_Den,            
                     snow_3h_24h_Den,            
                     clouds_all_24h_Den,          
                     weather_id_24h_Den,         
                     weather_main_24h_Den,      
                     weather_description_24h_Den) 
save(Denver_24h, file = 'Denver_24h.rda')
```
############################################################################################################
############################################################################################################



############################################################################################################
New Data Frame, and Clean-up, re-import
############################################################################################################
Create Final Data frame
```{r include=FALSE}
as.matrix(Denver)
as.matrix(Denver_1h)
as.matrix(Denver_3h)
as.matrix(Denver_6h)
as.matrix(Denver_12h)
as.matrix(Denver_24h)

Mat_Dat=cbind(Denver,Denver_1h,Denver_3h,Denver_6h,Denver_12h,Denver_24h)
FinalDat=data.frame(Mat_Dat)

save(FinalDat, file = 'FinalDat.rda')

Denver=data.frame(Denver)
Denver_1h=data.frame(Denver_1h)
Denver_3h=data.frame(Denver_3h)
Denver_6h=data.frame(Denver_6h)
Denver_12h=data.frame(Denver_12h)
Denver_24h=data.frame(Denver_24h)
```
############################################################################################################
Clean up Work Space, re-import data sets
```{r include=FALSE}
rm(list=ls())
load("FinalDat.rda")
```
############################################################################################################
############################################################################################################



############################################################################################################
Calculate indicator response variable
############################################################################################################
```{r include=FALSE}
descr_ind=c()
descr_ind[1:35888]=NA

prev_sum=c()
prev_sum[1:35888]=NA

resp_ind=c()
resp_ind[1:35888]=NA

for(i in 1:35888)
{
  if((FinalDat$weather_main[i]=="Drizzle")|(FinalDat$weather_main[i]=="Fog")|(FinalDat$weather_main[i]=="Mist")|
     (FinalDat$weather_main[i]=="Rain")|(FinalDat$weather_main[i]=="Snow")|(FinalDat$weather_main[i]=="Squall")|
     (FinalDat$weather_main[i]=="Thunderstorm"))
    {descr_ind[i]=1}
  else
    {descr_ind[i]=0} 
}

for(i in 1:35863)
{
  prev_sum[i]=sum(descr_ind[(i+1):(i+24)])
}

for(i in 1:34864)
{
  if(prev_sum[i]>0)
  {
    resp_ind[i]=1
  }
  else
  {resp_ind[i]=0}
}

FinalDat$Question=resp_ind

save(FinalDat, file = 'FinalDat.rda')
rm(resp_ind)
rm(prev_sum)
rm(descr_ind)
rm(i)
```
############################################################################################################
############################################################################################################



############################################################################################################
Translate Weather-Main Variables
############################################################################################################
```{r include = FALSE}
weather_main_new = c()
weather_main_factor=as.factor(FinalDat$weather_main)
weather_main_new[1:35888] = NA

for (i in 1:35888)
{
  if ((FinalDat$weather_main[i] == 'Drizzle') |
      (FinalDat$weather_main[i] == 'Fog') |
      (FinalDat$weather_main[i] == 'Mist') |
      (FinalDat$weather_main[i] == 'Rain') |
      (FinalDat$weather_main[i] == 'Rain') |
      (FinalDat$weather_main[i] == 'Snow') |
      (FinalDat$weather_main[i] == 'Squall') |
      (FinalDat$weather_main[i] == 'Thunderstorm'))
  {weather_main_new[i] <- 1}
  
      else
    {
      weather_main_new[i] <- 0
    }
}

#creating weather main indicator
FinalDat$weather_main_1h_Den_Dummy <- ifelse(FinalDat$weather_main_1h_Den==3 | FinalDat$weather_main_1h_Den==5 |FinalDat$weather_main_1h_Den== 7 | FinalDat$weather_main_1h_Den==8 | FinalDat$weather_main_1h_Den== 10 |FinalDat$weather_main_1h_Den== 11| FinalDat$weather_main_1h_Den==12, 1, 0)
FinalDat$weather_main_3h_Den_Dummy <- ifelse(FinalDat$weather_main_3h_Den==3 | FinalDat$weather_main_3h_Den==5 |FinalDat$weather_main_3h_Den== 7 | FinalDat$weather_main_3h_Den==8 | FinalDat$weather_main_3h_Den== 10 |FinalDat$weather_main_3h_Den== 11| FinalDat$weather_main_3h_Den==12, 1, 0)
FinalDat$weather_main_6h_Den_Dummy <- ifelse(FinalDat$weather_main_6h_Den==3 | FinalDat$weather_main_6h_Den==5 |FinalDat$weather_main_6h_Den== 7 | FinalDat$weather_main_6h_Den==8 | FinalDat$weather_main_6h_Den== 10 |FinalDat$weather_main_6h_Den== 11| FinalDat$weather_main_6h_Den==12, 1, 0)
FinalDat$weather_main_12h_Den_Dummy <- ifelse(FinalDat$weather_main_12h_Den==3 | FinalDat$weather_main_12h_Den==5 |FinalDat$weather_main_12h_Den== 7 | FinalDat$weather_main_12h_Den==8 | FinalDat$weather_main_12h_Den== 10 |FinalDat$weather_main_12h_Den== 11| FinalDat$weather_main_12h_Den==12, 1, 0)
FinalDat$weather_main_24h_Den_Dummy <- ifelse(FinalDat$weather_main_24h_Den==3 | FinalDat$weather_main_24h_Den==5 |FinalDat$weather_main_24h_Den== 7 | FinalDat$weather_main_24h_Den==8 | FinalDat$weather_main_24h_Den== 10 |FinalDat$weather_main_24h_Den== 11| FinalDat$weather_main_24h_Den==12, 1, 0)
save(FinalDat, file = 'FinalDat.rda')
rm(weather_main_factor)
rm(weather_main_new)
rm(i)
```
############################################################################################################
############################################################################################################



############################################################################################################
Convert Angle Measurements to 
############################################################################################################
```{r include=FALSE}
## create wind direction variable
directions <-c("N","NNE","NE","ENE","E","ESE","SE","SSE","S","SSW","SW","WSW","W","WNW","NW","NNW","SN")
deg <- c(0,11.25,33.75,56.25,78.75,101.25,123.75,146.25,168.75,191.25,213.75,236.25,258.75,281.25,303.75,326.25,348.75,360)
FinalDat$wind_dir <- cut(FinalDat$wind_deg, deg, labels = directions,right = FALSE)
FinalDat$wind_dir_1h_Den <- cut(FinalDat$wind_deg_1h_Den, deg, labels = directions, right = FALSE)
FinalDat$wind_dir_3h_Den <- cut(FinalDat$wind_deg_3h_Den, deg, labels = directions, right = FALSE)
FinalDat$wind_dir_6h_Den <- cut(FinalDat$wind_deg_6h_Den, deg, labels = directions, right = FALSE)
FinalDat$wind_dir_12h_Den <- cut(FinalDat$wind_deg_12h_Den, deg, labels = directions, right = FALSE)
FinalDat$wind_dir_24h_Den <- cut(FinalDat$wind_deg_24h_Den, deg, labels = directions, right = FALSE)

#change the label SN to N
FinalDat$wind_dir[FinalDat$wind_dir=="SN"] <- c("N")
FinalDat$wind_dir_1h_Den[FinalDat$wind_dir_1h_Den=="SN"] <- c("N")
FinalDat$wind_dir_3h_Den[FinalDat$wind_dir_3h_Den=="SN"] <- c("N")
FinalDat$wind_dir_6h_Den[FinalDat$wind_dir_6h_Den=="SN"] <- c("N")
FinalDat$wind_dir_12h_Den[FinalDat$wind_dir_12h_Den=="SN"] <- c("N")
FinalDat$wind_dir_24h_Den[FinalDat$wind_dir_24h_Den=="SN"] <- c("N")

save(FinalDat, file = 'FinalDat.rda')

rm(deg)
rm(directions)
```
############################################################################################################
############################################################################################################



############################################################################################################
Kill unused columns and Rows with NAs
############################################################################################################
```{r include=FALSE}
FinalDat2=FinalDat[,-c(1,9,17,22,23,24,25,26,34,41,42,50,57,58,66,73,74,82,89,90,98,105,106)]
FinalDat2=FinalDat2[complete.cases(FinalDat2),]
save(FinalDat2, file = 'FinalDat2.rda')
```
############################################################################################################
############################################################################################################




############################################################################################################
MODEL ANALYSIS
############################################################################################################
############################################################################################################
Define Sample=RANDOM SAMPLE, training and test sets
############################################################################################################
```{r include=FALSE}
load('FinalDat2.rda')
dat <- FinalDat2
set.seed(101)
dat_sample <- dat[sample(nrow(dat), 3000),]
sample = sample.split(dat_sample, SplitRatio = 0.75)
trainset = subset(dat_sample, sample == TRUE)
testset  = subset(dat_sample, sample == FALSE)
Q_train = as.factor(trainset$Question)
Q_test = as.factor(testset$Question)
```
############################################################################################################


############################################################################################################
############################################################################################################
24 Hour Model and Analytics
############################################################################################################
```{r}
  ans24hrs <- glm(as.factor(Question) ~ temp_24h_Den
  + pressure_24h_Den + humidity_24h_Den + wind_speed_24h_Den + wind_dir_24h_Den
  + rain_1h_24h_Den + rain_3h_24h_Den + snow_1h_24h_Den
  + snow_3h_24h_Den + clouds_all_24h_Den
  + weather_main_24h_Den_Dummy,
  family = binomial(),
  data = trainset)

summary(ans24hrs)
plot(ans24hrs)

glm.probs_train = predict(ans24hrs, type = "response")
glm.probs_test = predict(ans24hrs, testset, type = "response")
glm_24.pred_train = rep(0, length(trainset$Question))
glm_24.pred_test = rep(0, length(testset$Question))
glm_24.pred_train[glm.probs_train > 0.5] = 1
glm_24.pred_test[glm.probs_test > 0.5] = 1
table(glm_24.pred_train, Q_train)
mean(glm_24.pred_train == Q_train)
table(glm_24.pred_test, Q_test)
mean(glm_24.pred_test == Q_test)

```
############################################################################################################


############################################################################################################
############################################################################################################
12 Hour Model and Analytics
############################################################################################################
```{r}
ans12hrs <- glm(
  as.factor(Question) ~
  temp_12h_Den
  + pressure_12h_Den + humidity_12h_Den + wind_speed_12h_Den + wind_dir_12h_Den
  + rain_1h_12h_Den + rain_3h_12h_Den + snow_1h_12h_Den + snow_3h_12h_Den 
  + clouds_all_12h_Den+ weather_main_12h_Den_Dummy
  + I(pressure_12h_Den - pressure_24h_Den) + I(temp_12h_Den - temp_24h_Den)
  + I(humidity_12h_Den - humidity_24h_Den) + I(wind_speed_12h_Den - wind_speed_24h_Den)
  ,family = binomial(), data = trainset)

summary(ans12hrs)
plot(ans12hrs)

glm.probs_train = predict(ans12hrs, type = "response")
glm.probs_test = predict(ans12hrs, testset, type = "response")
glm_12.pred_train = rep(0, length(trainset$Question))
glm_12.pred_test = rep(0, length(testset$Question))
glm_12.pred_train[glm.probs_train > 0.5] = 1
glm_12.pred_test[glm.probs_test > 0.5] = 1
table(glm_12.pred_train, Q_train)
mean(glm_12.pred_train == Q_train)
table(glm_12.pred_test, Q_test)
mean(glm_12.pred_test == Q_test)
```
############################################################################################################


############################################################################################################
############################################################################################################
6 Hour Model and Analytics
############################################################################################################
```{r}
ans6hrs <- glm(as.factor(Question) ~ temp_6h_Den + pressure_6h_Den + humidity_6h_Den 
               + wind_speed_6h_Den + wind_dir_6h_Den + rain_1h_6h_Den + rain_3h_6h_Den + snow_1h_6h_Den
               + snow_3h_6h_Den + clouds_all_6h_Den + weather_main_6h_Den_Dummy
               + I(pressure_6h_Den - pressure_24h_Den) + I(temp_6h_Den - temp_24h_Den)
               + I(humidity_6h_Den - humidity_24h_Den) + I(wind_speed_6h_Den - wind_speed_24h_Den)
               + I(pressure_6h_Den - pressure_12h_Den) + I(temp_6h_Den - temp_12h_Den)
               + I(humidity_6h_Den - humidity_12h_Den) + I(wind_speed_6h_Den - wind_speed_12h_Den)
               , family = binomial(), data = trainset)

summary(ans6hrs)
plot(ans6hrs)

glm.probs_train = predict(ans6hrs, type = "response")
glm.probs_test = predict(ans6hrs, testset, type = "response")
glm_6.pred_train = rep(0, length(trainset$Question))
glm_6.pred_test = rep(0, length(testset$Question))
glm_6.pred_train[glm.probs_train > 0.5] = 1
glm_6.pred_test[glm.probs_test > 0.5] = 1
table(glm_6.pred_train, Q_train)
mean(glm_6.pred_train == Q_train)
table(glm_6.pred_test, Q_test)
mean(glm_6.pred_test == Q_test)
```
############################################################################################################



############################################################################################################
############################################################################################################
3 Hour Model and Analytics
############################################################################################################
```{r}
ans3hrs <- glm(as.factor(Question) ~ temp_3h_Den + pressure_3h_Den + humidity_3h_Den 
               + wind_speed_3h_Den + wind_dir_3h_Den + rain_1h_3h_Den + rain_3h_3h_Den
               + snow_1h_3h_Den+ snow_3h_3h_Den + clouds_all_3h_Den + weather_main_3h_Den_Dummy
               + I(pressure_3h_Den - pressure_24h_Den) + I(temp_3h_Den - temp_24h_Den)
               + I(humidity_3h_Den - humidity_24h_Den) + I(wind_speed_3h_Den - wind_speed_24h_Den)
               + I(pressure_3h_Den - pressure_12h_Den) + I(temp_3h_Den - temp_12h_Den)
               + I(humidity_3h_Den - humidity_12h_Den) + I(wind_speed_3h_Den - wind_speed_12h_Den)
               + I(pressure_3h_Den - pressure_6h_Den) + I(temp_3h_Den - temp_6h_Den)
               + I(humidity_3h_Den - humidity_6h_Den) + I(wind_speed_3h_Den - wind_speed_6h_Den),
                family = binomial(),data = trainset)
	
summary(ans3hrs)
plot(ans3hrs)

glm.probs_train = predict(ans3hrs, type = "response")
glm.probs_test = predict(ans3hrs, testset, type = "response")
glm_3.pred_train = rep(0, length(trainset$Question))
glm_3.pred_test = rep(0, length(testset$Question))
glm_3.pred_train[glm.probs_train > 0.5] = 1
glm_3.pred_test[glm.probs_test > 0.5] = 1
table(glm_3.pred_train, Q_train)
mean(glm_3.pred_train == Q_train)
table(glm_3.pred_test, Q_test)
mean(glm_3.pred_test == Q_test)
```
############################################################################################################


############################################################################################################
############################################################################################################
1 Hour Model and Analytics
############################################################################################################
```{r}
ans1hrs <- glm(as.factor(Question) ~ temp_1h_Den + pressure_1h_Den + humidity_1h_Den + wind_speed_1h_Den 
  + wind_dir_1h_Den + rain_1h_1h_Den + rain_3h_1h_Den + snow_1h_1h_Den + snow_3h_1h_Den 
  + clouds_all_1h_Den + weather_main_1h_Den_Dummy
  + I(pressure_1h_Den - pressure_24h_Den) + I(temp_1h_Den - temp_24h_Den)
  + I(humidity_1h_Den - humidity_24h_Den) + I(wind_speed_1h_Den - wind_speed_24h_Den)
  + I(pressure_1h_Den - pressure_12h_Den) + I(temp_1h_Den - temp_12h_Den)
  + I(humidity_1h_Den - humidity_12h_Den) + I(wind_speed_1h_Den - wind_speed_12h_Den)
  + I(pressure_1h_Den - pressure_6h_Den) + I(temp_1h_Den - temp_6h_Den)
  + I(humidity_1h_Den - humidity_6h_Den) + I(wind_speed_1h_Den - wind_speed_6h_Den)
  + I(pressure_1h_Den - pressure_3h_Den) + I(temp_1h_Den - temp_3h_Den)
  + I(humidity_1h_Den - humidity_3h_Den) + I(wind_speed_1h_Den - wind_speed_3h_Den),family = binomial(),
  data = trainset)
	
summary(ans1hrs)
plot(ans1hrs)

glm.probs_train = predict(ans1hrs, type = "response")
glm.probs_test = predict(ans1hrs, testset, type = "response")
glm_1.pred_train = rep(0, length(trainset$Question))
glm_1.pred_test = rep(0, length(testset$Question))
glm_1.pred_train[glm.probs_train > 0.5] = 1
glm_1.pred_test[glm.probs_test > 0.5] = 1
table(glm_1.pred_train, Q_train)
mean(glm_1.pred_train == Q_train)
table(glm_1.pred_test, Q_test)
mean(glm_1.pred_test == Q_test)
```
############################################################################################################

############################################################################################################
############################################################################################################
############################################################################################################

############################################################################################################
Remove Variables
############################################################################################################
```{r include=FALSE}
rm(list=ls())
load('FinalDat2.rda')
```
############################################################################################################
############################################################################################################




